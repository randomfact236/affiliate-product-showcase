{
  "audit_date": "2026-02-02T18:33:39.578299",
  "summary": {
    "total_files": 152,
    "total_issues": 195,
    "critical": 84,
    "high": 111,
    "medium": 0,
    "low": 0
  },
  "input_sanitization": [
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 82,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if (!isset($_POST['nonce']) || !wp_verify_nonce($_POST['nonce'], $action)) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 250,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "'featured' => isset($_POST['featured']) ? filter_var($_POST['featured'], FILTER_VALIDATE_BOOLEAN) : false,",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 442,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if (!isset($_POST['nonce']) || !wp_verify_nonce($_POST['nonce'], 'aps_product_table_ui')) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 587,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if (!isset($_POST['nonce']) || !wp_verify_nonce($_POST['nonce'], 'aps_products_nonce')) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 757,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$product_data = isset($_POST['data']) && is_array($_POST['data']) ? $_POST['data'] : [];",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\BulkActions.php",
      "line": 252,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if (!isset($_GET['bulk_action']) || !isset($_GET['processed'])) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\BulkActions.php",
      "line": 354,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( ! isset( $_GET['file'] ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\CategoryFields.php",
      "line": 197,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$featured = isset( $_POST['_aps_category_featured'] ) && '1' === $_POST['_aps_category_featured'] ? '1' : '0';",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\CategoryFields.php",
      "line": 210,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$image_url_input = isset( $_POST['_aps_category_image'] )",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\CategoryFields.php",
      "line": 211,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "? wp_unslash( $_POST['_aps_category_image'] )",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\CategoryFields.php",
      "line": 234,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$is_default = isset( $_POST['_aps_category_is_default'] ) && '1' === $_POST['_aps_category_is_default'];",
      "issue": "Unsanitized direct_superglobal",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\CategoryFields.php",
      "line": 401,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$current_sort_order = isset( $_GET['aps_sort_order'] ) &&",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\CategoryFormHandler.php",
      "line": 80,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( ! isset( $_POST['aps_category_form_nonce'] ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\CategoryFormHandler.php",
      "line": 144,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "'description' => isset( $_POST['description'] ) ? sanitize_textarea_field( wp_unslash( $_POST['description'] ) ) : '',",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\CategoryFormHandler.php",
      "line": 146,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "'featured'    => isset( $_POST['featured'] ) && '1' === $_POST['featured'],",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\Enqueue.php",
      "line": 428,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( $pagenow !== 'edit.php' || ! isset( $_GET['post_type'] ) || $_GET['post_type'] !== 'aps_product' ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\Menu.php",
      "line": 126,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( ! isset( $_GET['post'] ) && ! isset( $_GET['post_type'] ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\Menu.php",
      "line": 131,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$post_id = isset( $_GET['post'] ) ? (int) $_GET['post'] : 0;",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\Menu.php",
      "line": 142,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( isset( $_GET['post_type'] ) && $_GET['post_type'] === 'aps_product' ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\Menu.php",
      "line": 283,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if (isset($_GET['post_type']) && $_GET['post_type'] === 'aps_product') {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\Menu.php",
      "line": 285,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if (!isset($_GET['orderby'])) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\Menu.php",
      "line": 593,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( isset( $_GET['post_type'] ) && $_GET['post_type'] === 'aps_product' ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\Menu.php",
      "line": 594,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( isset( $_GET['page'] ) && $_GET['page'] === 'add-product' ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFilters.php",
      "line": 57,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$selected = isset($_GET['aps_category_filter']) ? (int) $_GET['aps_category_filter'] : 0;",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFilters.php",
      "line": 97,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$selected = isset($_GET['aps_tag_filter']) ? (int) $_GET['aps_tag_filter'] : 0;",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFilters.php",
      "line": 127,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$is_checked = isset($_GET['featured_filter']) ? checked('1', $_GET['featured_filter'], false) : '';",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFilters.php",
      "line": 147,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$search_value = isset($_GET['aps_search']) ? esc_attr($_GET['aps_search']) : '';",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFilters.php",
      "line": 171,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if (isset($_GET['aps_category_filter']) && !empty($_GET['aps_category_filter'])) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFilters.php",
      "line": 172,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$category_id = (int) $_GET['aps_category_filter'];",
      "issue": "Unsanitized direct_superglobal",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFilters.php",
      "line": 190,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if (isset($_GET['aps_tag_filter']) && !empty($_GET['aps_tag_filter'])) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFilters.php",
      "line": 191,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$tag_id = (int) $_GET['aps_tag_filter'];",
      "issue": "Unsanitized direct_superglobal",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFilters.php",
      "line": 209,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if (isset($_GET['featured_filter']) && '1' === $_GET['featured_filter']) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFilters.php",
      "line": 225,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if (isset($_GET['aps_status_filter']) && !empty($_GET['aps_status_filter'])) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFilters.php",
      "line": 231,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if (isset($_GET['aps_search']) && !empty($_GET['aps_search'])) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 92,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$is_update = isset( $_POST['post_id'] ) && ! empty( $_POST['post_id'] );",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 95,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$post_id = (int) $_POST['post_id'];",
      "issue": "Unsanitized direct_superglobal",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 198,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$data['is_draft'] = isset( $_POST['draft'] );",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductsAjaxHandler.php",
      "line": 70,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$product_ids = isset($_POST['product_ids']) ? json_decode(stripslashes($_POST['product_ids']), true) : [];",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductsAjaxHandler.php",
      "line": 175,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$price = isset($_POST['price']) ? floatval($_POST['price']) : 0.0;",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductsAjaxHandler.php",
      "line": 178,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$featured = isset($_POST['featured']) && $_POST['featured'] === '1';",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductsTable.php",
      "line": 96,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if (isset($_GET['status']) && !empty($_GET['status'])) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductsTable.php",
      "line": 107,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if (isset($_GET['category']) && !empty($_GET['category'])) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductsTable.php",
      "line": 118,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if (isset($_GET['tag']) && !empty($_GET['tag'])) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductsTable.php",
      "line": 128,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if (isset($_GET['s']) && !empty($_GET['s'])) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\RibbonFields.php",
      "line": 306,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( isset( $_POST['aps_ribbon_color'] ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\RibbonFields.php",
      "line": 307,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$color = sanitize_hex_color( wp_unslash( $_POST['aps_ribbon_color'] ) );",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\RibbonFields.php",
      "line": 316,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( isset( $_POST['aps_ribbon_bg_color'] ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\RibbonFields.php",
      "line": 317,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$bg_color = sanitize_hex_color( wp_unslash( $_POST['aps_ribbon_bg_color'] ) );",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\RibbonFields.php",
      "line": 326,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( isset( $_POST['aps_ribbon_icon'] ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TagFields.php",
      "line": 293,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$featured = isset( $_POST['_aps_tag_featured'] ) ? '1' : '0';",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TagFields.php",
      "line": 299,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$is_default = isset( $_POST['_aps_tag_is_default'] ) ? '1' : '0';",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TagFields.php",
      "line": 312,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$icon = isset( $_POST['_aps_tag_icon'] )",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TagFields.php",
      "line": 320,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$image_url = isset( $_POST['_aps_tag_image_url'] )",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TagFields.php",
      "line": 328,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( isset( $_POST['_aps_tag_color'] ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TagFields.php",
      "line": 329,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$color = sanitize_hex_color( wp_unslash( $_POST['_aps_tag_color'] ) );",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TagFields.php",
      "line": 338,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( isset( $_POST['_aps_tag_bg_color'] ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TagFields.php",
      "line": 339,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$bg = sanitize_hex_color( wp_unslash( $_POST['_aps_tag_bg_color'] ) );",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TaxonomyFieldsAbstract.php",
      "line": 223,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( ! isset( $_POST[ $nonce_name ] ) ||",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TaxonomyFieldsAbstract.php",
      "line": 224,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "! wp_verify_nonce( wp_unslash( $_POST[ $nonce_name ] ), $this->get_nonce_action( 'fields' ) ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TaxonomyFieldsAbstract.php",
      "line": 721,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( isset( $_GET['moved_to_draft'] ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TaxonomyFieldsAbstract.php",
      "line": 732,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( isset( $_GET['moved_to_trash'] ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TaxonomyFieldsAbstract.php",
      "line": 743,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( isset( $_GET['restored_from_trash'] ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TaxonomyFieldsAbstract.php",
      "line": 754,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( isset( $_GET['permanently_deleted'] ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TaxonomyFieldsAbstract.php",
      "line": 774,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( ! isset( $_POST['nonce'] ) || ! wp_verify_nonce( $_POST['nonce'], $this->get_nonce_action( 'toggle_status' ) ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TaxonomyFieldsAbstract.php",
      "line": 784,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$term_id = isset( $_POST['term_id'] ) ? (int) $_POST['term_id'] : 0;",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TaxonomyFieldsAbstract.php",
      "line": 815,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( ! isset( $_POST['nonce'] ) || ! wp_verify_nonce( $_POST['nonce'], $this->get_nonce_action( 'row_action' ) ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TaxonomyFieldsAbstract.php",
      "line": 823,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$term_id = isset( $_POST['term_id'] ) ? (int) $_POST['term_id'] : 0;",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TaxonomyFieldsAbstract.php",
      "line": 957,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$term_id = isset( $_GET['term_id'] ) ? (int) $_GET['term_id'] : 0;",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TaxonomyFieldsAbstract.php",
      "line": 1040,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( isset( $_GET['status'] ) && in_array( $_GET['status'], self::VALID_STATUSES, true ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TaxonomyFieldsAbstract.php",
      "line": 1053,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "if ( isset( $_GET['do'] ) && in_array( $_GET['do'], self::VALID_ACTIONS, true ) ) {",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\add-product-page.php",
      "line": 17,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$post_id = isset( $_GET['post'] ) ? (int) $_GET['post'] : 0;",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\products-page.php",
      "line": 36,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "class=\"nav-tab <?php echo isset($_GET['status']) && $_GET['status'] === 'all' ? 'nav-tab-active' : ''; ?>\">",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\products-page.php",
      "line": 46,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "class=\"nav-tab <?php echo isset($_GET['status']) && $_GET['status'] === 'published' ? 'nav-tab-active' : ''; ?>\">",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\products-page.php",
      "line": 56,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "class=\"nav-tab <?php echo isset($_GET['status']) && $_GET['status'] === 'draft' ? 'nav-tab-active' : ''; ?>\">",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\products-page.php",
      "line": 66,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "class=\"nav-tab <?php echo isset($_GET['status']) && $_GET['status'] === 'trash' ? 'nav-tab-active' : ''; ?>\">",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\products-page.php",
      "line": 100,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "$selected = isset($_GET['category']) && $_GET['category'] === $category->slug ? 'selected' : '';",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\products-page.php",
      "line": 117,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "<option value=\"published\" <?php echo isset($_GET['status_filter']) && $_GET['status_filter'] === 'published' ? 'selected' : ''; ?>>",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\products-page.php",
      "line": 120,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "<option value=\"draft\" <?php echo isset($_GET['status_filter']) && $_GET['status_filter'] === 'draft' ? 'selected' : ''; ?>>",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\products-page.php",
      "line": 123,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "<option value=\"trash\" <?php echo isset($_GET['status_filter']) && $_GET['status_filter'] === 'trash' ? 'selected' : ''; ?>>",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\products-page.php",
      "line": 136,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "<?php if (isset($_GET['status'])): ?>",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Traits\\NonceVerificationTrait.php",
      "line": 45,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "return isset($_POST[$key]) && $this->verify_nonce($_POST[$key], $action);",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Validators\\UrlValidator.php",
      "line": 124,
      "type": "input_sanitization",
      "severity": "critical",
      "code": "* $result = UrlValidator::validate_with_result( $_POST['url'] );",
      "issue": "Unsanitized unescaped_input",
      "suggestion": "Use sanitize_text_field(), sanitize_email(), or appropriate WordPress sanitization function"
    }
  ],
  "output_escaping": [
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\Menu.php",
      "line": 242,
      "type": "output_escaping",
      "severity": "high",
      "code": "echo $featured ? '<span class=\"aps-featured-star\">\u2605</span>' : '';",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\Helpers\\TemplateHelpers.php",
      "line": 43,
      "type": "output_escaping",
      "severity": "high",
      "code": "<div class=\"upload-placeholder\" style=\"<?php echo $placeholderStyle; ?>\">",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\Helpers\\TemplateHelpers.php",
      "line": 109,
      "type": "output_escaping",
      "severity": "high",
      "code": "<?php echo $requiredAttr; ?>",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\Helpers\\TemplateHelpers.php",
      "line": 110,
      "type": "output_escaping",
      "severity": "high",
      "code": "<?php echo $attrString; ?>>",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\Helpers\\TemplateHelpers.php",
      "line": 156,
      "type": "output_escaping",
      "severity": "high",
      "code": "<?php echo $requiredAttr; ?>",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\settings-page.php",
      "line": 22,
      "type": "output_escaping",
      "severity": "high",
      "code": "class=\"aps-tab <?php echo $active_tab === 'general' ? 'active' : ''; ?>\">",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\settings-page.php",
      "line": 28,
      "type": "output_escaping",
      "severity": "high",
      "code": "class=\"aps-tab <?php echo $active_tab === 'display' ? 'active' : ''; ?>\">",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\settings-page.php",
      "line": 34,
      "type": "output_escaping",
      "severity": "high",
      "code": "class=\"aps-tab <?php echo $active_tab === 'products' ? 'active' : ''; ?>\">",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\settings-page.php",
      "line": 40,
      "type": "output_escaping",
      "severity": "high",
      "code": "class=\"aps-tab <?php echo $active_tab === 'categories' ? 'active' : ''; ?>\">",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\settings-page.php",
      "line": 46,
      "type": "output_escaping",
      "severity": "high",
      "code": "class=\"aps-tab <?php echo $active_tab === 'tags' ? 'active' : ''; ?>\">",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\settings-page.php",
      "line": 52,
      "type": "output_escaping",
      "severity": "high",
      "code": "class=\"aps-tab <?php echo $active_tab === 'ribbons' ? 'active' : ''; ?>\">",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\settings-page.php",
      "line": 58,
      "type": "output_escaping",
      "severity": "high",
      "code": "class=\"aps-tab <?php echo $active_tab === 'performance' ? 'active' : ''; ?> disabled\">",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\settings-page.php",
      "line": 65,
      "type": "output_escaping",
      "severity": "high",
      "code": "class=\"aps-tab <?php echo $active_tab === 'security' ? 'active' : ''; ?>\">",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\settings-page.php",
      "line": 71,
      "type": "output_escaping",
      "severity": "high",
      "code": "class=\"aps-tab <?php echo $active_tab === 'import_export' ? 'active' : ''; ?>\">",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\settings-page.php",
      "line": 77,
      "type": "output_escaping",
      "severity": "high",
      "code": "class=\"aps-tab <?php echo $active_tab === 'shortcodes' ? 'active' : ''; ?>\">",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\partials\\settings-page.php",
      "line": 83,
      "type": "output_escaping",
      "severity": "high",
      "code": "class=\"aps-tab <?php echo $active_tab === 'widgets' ? 'active' : ''; ?>\">",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\Blocks.php",
      "line": 113,
      "type": "output_escaping",
      "severity": "high",
      "code": "<?php echo $this->render_stars( $product->rating ); ?>",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\Blocks.php",
      "line": 119,
      "type": "output_escaping",
      "severity": "high",
      "code": "<span class=\"aps-current-price\"><?php echo $this->price_formatter->format( $product->price, $product->currency ); ?></span>",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\Blocks.php",
      "line": 121,
      "type": "output_escaping",
      "severity": "high",
      "code": "<span class=\"aps-original-price\"><?php echo $this->price_formatter->format( $product->original_price, $product->currency ); ?></span>",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\Blocks.php",
      "line": 175,
      "type": "output_escaping",
      "severity": "high",
      "code": "data-show-price=\"<?php echo $show_price ? 'true' : 'false'; ?>\"",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\Blocks.php",
      "line": 176,
      "type": "output_escaping",
      "severity": "high",
      "code": "data-show-description=\"<?php echo $show_description ? 'true' : 'false'; ?>\"",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\Blocks.php",
      "line": 177,
      "type": "output_escaping",
      "severity": "high",
      "code": "data-show-button=\"<?php echo $show_button ? 'true' : 'false'; ?>\"",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\Blocks.php",
      "line": 206,
      "type": "output_escaping",
      "severity": "high",
      "code": "<span class=\"aps-current-price\"><?php echo $this->price_formatter->format( $product->price, $product->currency ); ?></span>",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\Blocks.php",
      "line": 208,
      "type": "output_escaping",
      "severity": "high",
      "code": "<span class=\"aps-original-price\"><?php echo $this->price_formatter->format( $product->original_price, $product->currency ); ?></span>",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\index.php",
      "line": 75,
      "type": "output_escaping",
      "severity": "high",
      "code": "data-show-price=\"<?php echo $show_price ? 'true' : 'false'; ?>\"",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\index.php",
      "line": 76,
      "type": "output_escaping",
      "severity": "high",
      "code": "data-show-description=\"<?php echo $show_description ? 'true' : 'false'; ?>\"",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\index.php",
      "line": 77,
      "type": "output_escaping",
      "severity": "high",
      "code": "data-show-button=\"<?php echo $show_button ? 'true' : 'false'; ?>\"",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\templates\\product-grid-item.php",
      "line": 55,
      "type": "output_escaping",
      "severity": "high",
      "code": "<?php echo $display_rating; // Already escaped in helper ?>",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\templates\\product-grid-item.php",
      "line": 61,
      "type": "output_escaping",
      "severity": "high",
      "code": "<span class=\"aps-current-price\"><?php echo $display_price; // Already escaped ?></span>",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\templates\\product-grid-item.php",
      "line": 63,
      "type": "output_escaping",
      "severity": "high",
      "code": "<span class=\"aps-original-price\"><?php echo $display_original_price; // Already escaped ?></span>",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\templates\\product-showcase-item.php",
      "line": 52,
      "type": "output_escaping",
      "severity": "high",
      "code": "<span class=\"aps-current-price\"><?php echo $display_price; // Already escaped ?></span>",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Blocks\\templates\\product-showcase-item.php",
      "line": 54,
      "type": "output_escaping",
      "severity": "high",
      "code": "<span class=\"aps-original-price\"><?php echo $display_original_price; // Already escaped ?></span>",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Public\\Enqueue.php",
      "line": 151,
      "type": "output_escaping",
      "severity": "high",
      "code": "trackingEnabled: <?php echo $this->isTrackingEnabled() ? 'true' : 'false'; ?>,",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Public\\Enqueue.php",
      "line": 152,
      "type": "output_escaping",
      "severity": "high",
      "code": "lazyLoad: <?php echo $this->isLazyLoadEnabled() ? 'true' : 'false'; ?>,",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Public\\Widgets.php",
      "line": 45,
      "type": "output_escaping",
      "severity": "high",
      "code": "echo $args['before_widget'];",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Public\\Widgets.php",
      "line": 47,
      "type": "output_escaping",
      "severity": "high",
      "code": "echo $args['before_title'] . apply_filters( 'widget_title', $instance['title'] ) . $args['after_title'];",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Public\\Widgets.php",
      "line": 55,
      "type": "output_escaping",
      "severity": "high",
      "code": "echo $args['after_widget'];",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Repositories\\CategoryRepository.php",
      "line": 45,
      "type": "output_escaping",
      "severity": "high",
      "code": "*     echo $category->name;",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Repositories\\TagRepository.php",
      "line": 45,
      "type": "output_escaping",
      "severity": "high",
      "code": "*     echo $tag->name;",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Validators\\UrlValidator.php",
      "line": 128,
      "type": "output_escaping",
      "severity": "high",
      "code": "*     echo $result['error'];",
      "issue": "Unescaped output",
      "suggestion": "Use esc_html(), esc_attr(), or appropriate WordPress escaping function"
    }
  ],
  "nonce_verification": [
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\TaxonomyFieldsAbstract.php",
      "line": 132,
      "type": "nonce_verification",
      "severity": "critical",
      "code": "add_action( 'wp_ajax_aps_' . $this->get_taxonomy() . '_row_action', [ $this, 'ajax_term_row_action' ] );",
      "issue": "AJAX handler without nonce verification",
      "suggestion": "Add check_ajax_referer(\"action_name\", \"nonce_field\") at the start of the handler"
    }
  ],
  "capability_checks": [
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 113,
      "type": "capability_checks",
      "severity": "high",
      "code": "$updated = wp_update_post([",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 132,
      "type": "capability_checks",
      "severity": "high",
      "code": "$updated = wp_update_post([",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 150,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta($product_id, '_aps_price', $price);",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 165,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta($product_id, '_aps_original_price', $original_price);",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 177,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta($product_id, '_aps_featured', $featured ? '1' : '0');",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 419,
      "type": "capability_checks",
      "severity": "high",
      "code": "$result = wp_update_post([",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 530,
      "type": "capability_checks",
      "severity": "high",
      "code": "return update_post_meta($product_id, '_aps_stock_status', 'in_stock');",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 533,
      "type": "capability_checks",
      "severity": "high",
      "code": "return update_post_meta($product_id, '_aps_stock_status', 'out_of_stock');",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 536,
      "type": "capability_checks",
      "severity": "high",
      "code": "return update_post_meta($product_id, '_aps_featured', '1');",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 539,
      "type": "capability_checks",
      "severity": "high",
      "code": "return update_post_meta($product_id, '_aps_featured', '0');",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 542,
      "type": "capability_checks",
      "severity": "high",
      "code": "return update_post_meta($product_id, '_aps_clicks', 0);",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\AjaxHandler.php",
      "line": 545,
      "type": "capability_checks",
      "severity": "high",
      "code": "return wp_delete_post($product_id, true) !== false;",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\BulkActions.php",
      "line": 96,
      "type": "capability_checks",
      "severity": "high",
      "code": "$result = update_post_meta( $post_id, '_in_stock', $in_stock );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 352,
      "type": "capability_checks",
      "severity": "high",
      "code": "$post_id = wp_insert_post(",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 390,
      "type": "capability_checks",
      "severity": "high",
      "code": "$result = wp_update_post(",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 420,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_price', $data['current_price'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 421,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_currency', $data['currency'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 422,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_affiliate_url', $data['affiliate_url'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 423,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_image_url', $data['image_url'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 424,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_video_url', $data['video_url'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 425,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_rating', $data['rating'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 426,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_featured', $data['featured'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 427,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_stock_status', $data['stock_status'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 428,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_seo_title', $data['seo_title'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 429,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_seo_description', $data['seo_description'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 432,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_logo', $data['logo'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 440,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_original_price', $data['original_price'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 441,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_price', $data['current_price'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 442,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_sale_price', $data['original_price'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 446,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_original_price', $existing_original_price );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 449,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_price', $existing_sale_price );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 450,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_sale_price', $existing_sale_price );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 453,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_price', $data['current_price'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 454,
      "type": "capability_checks",
      "severity": "high",
      "code": "delete_post_meta( $post_id, '_aps_sale_price' );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 458,
      "type": "capability_checks",
      "severity": "high",
      "code": "delete_post_meta( $post_id, '_aps_original_price' );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 459,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_price', $data['current_price'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 460,
      "type": "capability_checks",
      "severity": "high",
      "code": "delete_post_meta( $post_id, '_aps_sale_price' );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 465,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_discount_percentage', $data['discount_percentage'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 467,
      "type": "capability_checks",
      "severity": "high",
      "code": "delete_post_meta( $post_id, '_aps_discount_percentage' );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 471,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_platform_requirements', $data['platform_requirements'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 472,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_version_number', $data['version_number'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 475,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_gallery', $data['gallery'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 478,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_brand_image', $data['brand_image'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 481,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_button_name', ! empty( $data['button_name'] ) ? $data['button_name'] : 'Buy Now' );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 484,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_user_count', $data['user_count'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 487,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_views', $data['views'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 490,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_reviews', $data['reviews'] );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 494,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta( $post_id, '_aps_features', json_encode( $data['features'] ) );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductFormHandler.php",
      "line": 496,
      "type": "capability_checks",
      "severity": "high",
      "code": "delete_post_meta( $post_id, '_aps_features' );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductsAjaxHandler.php",
      "line": 204,
      "type": "capability_checks",
      "severity": "high",
      "code": "$result = wp_update_post($update_data);",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductsAjaxHandler.php",
      "line": 211,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta($product_id, '_aps_price', $price);",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductsAjaxHandler.php",
      "line": 215,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta($product_id, '_aps_currency', $currency);",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Admin\\ProductsAjaxHandler.php",
      "line": 225,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta($product_id, '_aps_featured', $featured ? 1 : 0);",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Database\\seeders\\sample-products.php",
      "line": 219,
      "type": "capability_checks",
      "severity": "high",
      "code": "$post_id = wp_insert_post([",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Database\\seeders\\sample-products.php",
      "line": 267,
      "type": "capability_checks",
      "severity": "high",
      "code": "update_post_meta($product_id, 'affiliate_product_' . $key, $value);",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Migrations\\RibbonMigration.php",
      "line": 66,
      "type": "capability_checks",
      "severity": "high",
      "code": "delete_post_meta( $product->ID, '_aps_ribbon' );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Migrations\\RibbonMigration.php",
      "line": 73,
      "type": "capability_checks",
      "severity": "high",
      "code": "delete_post_meta( $product->ID, '_aps_ribbon' );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Repositories\\ProductRepository.php",
      "line": 305,
      "type": "capability_checks",
      "severity": "high",
      "code": "$stored_id = wp_insert_post( $postarr, true );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Repositories\\ProductRepository.php",
      "line": 423,
      "type": "capability_checks",
      "severity": "high",
      "code": "delete_post_meta( $post_id, 'aps_categories' );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Repositories\\ProductRepository.php",
      "line": 446,
      "type": "capability_checks",
      "severity": "high",
      "code": "delete_post_meta( $post_id, 'aps_tags' );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Repositories\\ProductRepository.php",
      "line": 469,
      "type": "capability_checks",
      "severity": "high",
      "code": "delete_post_meta( $post_id, 'aps_ribbons' );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Repositories\\ProductRepository.php",
      "line": 508,
      "type": "capability_checks",
      "severity": "high",
      "code": "$result = update_post_meta( $post_id, $key, $value );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Repositories\\ProductRepository.php",
      "line": 521,
      "type": "capability_checks",
      "severity": "high",
      "code": "* Determines if update_post_meta operation failed.",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Repositories\\ProductRepository.php",
      "line": 523,
      "type": "capability_checks",
      "severity": "high",
      "code": "* @param mixed $result Result from update_post_meta",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Repositories\\ProductRepository.php",
      "line": 529,
      "type": "capability_checks",
      "severity": "high",
      "code": "// update_post_meta returns false on FAILURE, not when value === false",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Repositories\\ProductRepository.php",
      "line": 556,
      "type": "capability_checks",
      "severity": "high",
      "code": "$deleted = wp_delete_post( $id, true );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Repositories\\ProductRepository.php",
      "line": 559,
      "type": "capability_checks",
      "severity": "high",
      "code": "throw RepositoryException::deleteFailed(__( 'Product', 'affiliate-product-showcase' ), __( 'wp_delete_post returned false', 'affiliate-product-showcase' ));",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Rest\\AffiliatesController.php",
      "line": 279,
      "type": "capability_checks",
      "severity": "high",
      "code": "$result = wp_delete_post( $id, $force );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Rest\\ProductsController.php",
      "line": 726,
      "type": "capability_checks",
      "severity": "high",
      "code": "$result = wp_delete_post( (int) $product_id, true );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Rest\\ProductsController.php",
      "line": 984,
      "type": "capability_checks",
      "severity": "high",
      "code": "wp_update_post( $post_data );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    },
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Rest\\ProductsController.php",
      "line": 1082,
      "type": "capability_checks",
      "severity": "high",
      "code": "$result = wp_update_post( $post_data, true );",
      "issue": "Admin operation without capability check",
      "suggestion": "Add if (!current_user_can(\"capability\")) { wp_die(\"Unauthorized\"); }"
    }
  ],
  "sql_injection": [
    {
      "file": "wp-content/plugins/affiliate-product-showcase/src\\Rest\\HealthController.php",
      "line": 91,
      "type": "sql_injection",
      "severity": "critical",
      "code": "$result = $wpdb->get_var( 'SELECT 1' );",
      "issue": "Potential SQL injection risk",
      "suggestion": "Use $wpdb->prepare(\"SELECT * FROM table WHERE id = %d\", $id)"
    }
  ]
}